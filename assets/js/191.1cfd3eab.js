(window.webpackJsonp=window.webpackJsonp||[]).push([[191],{589:function(e,a,t){"use strict";t.r(a);var s=t(43),n=Object(s.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"scheme-adapter-to-scheme-adapter-testing"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#scheme-adapter-to-scheme-adapter-testing"}},[e._v("#")]),e._v(" Scheme Adapter to Scheme Adapter testing")]),e._v(" "),t("p",[e._v("A detailed documentation for dfsps who want to test the transfer of funds from a scheme adapter to another scheme adapter directly using mock backend and mojaloop simulator services.")]),e._v(" "),t("p",[t("img",{attrs:{src:"scheme-adapter-to-scheme-adapter-overview.png",alt:"Overview"}})]),e._v(" "),t("h2",{attrs:{id:"prerequisite"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prerequisite"}},[e._v("#")]),e._v(" Prerequisite")]),e._v(" "),t("ul",[t("li",[e._v("Mojaloop Simulator")]),e._v(" "),t("li",[e._v("DFSP mock backend service")]),e._v(" "),t("li",[e._v("Scheme adapter is already included in both the above docker-compose scripts")])]),e._v(" "),t("h2",{attrs:{id:"configuration-starting-services"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configuration-starting-services"}},[e._v("#")]),e._v(" Configuration & Starting services")]),e._v(" "),t("p",[e._v("The idea is to run two docker-compose scripts in parallel from the above two services. To avoid conflicts we need to edit the docker-compose.yml files and specify the container names.")]),e._v(" "),t("h3",{attrs:{id:"mojaloop-simulator-service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mojaloop-simulator-service"}},[e._v("#")]),e._v(" Mojaloop Simulator service")]),e._v(" "),t("p",[e._v("Please download the Mojaloop Simulator repo")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git clone https://github.com/mojaloop/mojaloop-simulator.git\n")])])]),t("ul",[t("li",[e._v("Edit the file src/docker-compose.yml and add the container names for all the containers. Please refer the following lines")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('version: \'3\'\nservices:\n  redis1:\n    image: "redis:5.0.4-alpine"\n    container_name: redis1\n  sim:\n    image: "mojaloop-simulator-backend"\n    build: ../\n    env_file: ./sim-backend.env\n    container_name: ml_sim1\n    ports:\n      - "13000:3000"\n      - "3001:3001"\n      - "3003:3003"\n    depends_on:\n      - scheme-adapter\n  scheme-adapter:\n    image: "mojaloop/sdk-scheme-adapter:latest"\n    env_file: ./scheme-adapter.env\n    container_name: sa_sim1\n    ports:\n      - "13500:3000"\n      - "14000:4000"\n    depends_on:\n      - redis1\n')])])]),t("ul",[t("li",[e._v("Edit the file src/sim-backend.env file and change the container name of the scheme adapter in that. Please refer the following lines.")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("OUTBOUND_ENDPOINT=http://sa_sim1:4001\n")])])]),t("ul",[t("li",[e._v("Edit the file src/scheme-adapter.env file and change the container names of the another scheme adapter and mojaloop simulator. Please refer the following lines")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("DFSP_ID=payeefsp\nCACHE_HOST=redis1\nPEER_ENDPOINT=sa_sim2:4000\nBACKEND_ENDPOINT=ml_sim1:3000\nAUTO_ACCEPT_PARTY=true\nAUTO_ACCEPT_QUOTES=true\nVALIDATE_INBOUND_JWS=false\nVALIDATE_INBOUND_PUT_PARTIES_JWS=false\nJWS_SIGN=true\nJWS_SIGN_PUT_PARTIES=true\n\n")])])]),t("p",[e._v("Then try running the following command to run the services")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("cd src/\ndocker-compose up -d\n")])])]),t("p",[e._v("We can now access the mojaloop simulator's test api on 3003.")]),e._v(" "),t("p",[e._v("A new party should be added to the simulator using the following command. Feel free to change the details you want.")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('curl -X POST "http://localhost:3003/repository/parties" -H "accept: */*" -H "Content-Type: application/json" -d "{\\"displayName\\":\\"Test Payee1\\",\\"firstName\\":\\"Test\\",\\"middleName\\":\\"\\",\\"lastName\\":\\"Payee1\\",\\"dateOfBirth\\":\\"1970-01-01\\",\\"idType\\":\\"MSISDN\\",\\"idValue\\":\\"9876543210\\"}"\n')])])]),t("p",[e._v("Then try to run the following command to check the new party added.")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('curl -X GET "http://localhost:3003/repository/parties" -H "accept: */*"\n')])])]),t("p",[e._v("Let's move on to setup another instance of scheme adapter with DFSP mock backend.")]),e._v(" "),t("h3",{attrs:{id:"dfsp-mock-backend-service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dfsp-mock-backend-service"}},[e._v("#")]),e._v(" DFSP Mock Backend service")]),e._v(" "),t("p",[e._v("The DFSP mock backend is a minimal implementation of an example DFSP. Only basic functions are supported at the moment.")]),e._v(" "),t("p",[e._v("Please download the following repository")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git clone https://github.com/mojaloop/sdk-mock-dfsp-backend.git\n")])])]),t("p",[e._v("Edit the files src/docker-compose.yml, src/backend.env and src/scheme-adapter.env and add the container names for all the containers. Please refer the following files.\ndocker-compose.yml")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('version: \'3\'\nservices:\n  redis2:\n    image: "redis:5.0.4-alpine"\n    container_name: redis2\n  backend:\n    image: "mojaloop/sdk-mock-dfsp-backend"\n    env_file: ./backend.env\n    container_name: dfsp_mock_backend2\n    ports:\n      - "23000:3000"\n    depends_on:\n      - scheme-adapter2\n\n  scheme-adapter2:\n    image: "mojaloop/sdk-scheme-adapter:latest"\n    env_file: ./scheme-adapter.env\n    container_name: sa_sim2\n    depends_on:\n      - redis2\n')])])]),t("p",[e._v("scheme-adapter.env")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("DFSP_ID=payerfsp\nCACHE_HOST=redis2\nPEER_ENDPOINT=sa_sim1:4000\nBACKEND_ENDPOINT=dfsp_mock_backend2:3000\nAUTO_ACCEPT_PARTY=true\nAUTO_ACCEPT_QUOTES=true\nVALIDATE_INBOUND_JWS=false\nVALIDATE_INBOUND_PUT_PARTIES_JWS=false\nJWS_SIGN=true\nJWS_SIGN_PUT_PARTIES=true\n\n")])])]),t("p",[e._v("backend.env")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("OUTBOUND_ENDPOINT=http://sa_sim2:4001\n")])])]),t("p",[e._v("Then try running the following command to run the services")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("cd src/\ndocker-compose up -d\n")])])]),t("h2",{attrs:{id:"try-to-send-money"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#try-to-send-money"}},[e._v("#")]),e._v(" Try to send money")]),e._v(" "),t("p",[e._v('Try to send funds from "payerfsp" (Mock DFSP) to a MSISDN which is in "payeefsp" (Mojaloop Simulator) through scheme adapter.\nRun the following curl command to issue command to Mock DFSP service.')]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('curl -X POST \\\n  http://localhost:23000/send \\\n  -H \'Content-Type: application/json\' \\\n  -d \'{\n    "from": {\n        "displayName": "John Doe",\n        "idType": "MSISDN",\n        "idValue": "123456789"\n    },\n    "to": {\n        "idType": "MSISDN",\n        "idValue": "9876543210"\n    },\n    "amountType": "SEND",\n    "currency": "USD",\n    "amount": "100",\n    "transactionType": "TRANSFER",\n    "note": "test payment",\n    "homeTransactionId": "123ABC"\n}\'\n')])])]),t("p",[e._v("You should get a response with COMPLETED currentState.")])])}),[],!1,null,null,null);a.default=n.exports}}]);