(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{354:function(e,t,a){e.exports=a.p+"assets/img/central-settlements-db-schema.8d302313.png"},558:function(e,t,a){"use strict";a.r(t);var n=a(43),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"settlement-process"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#settlement-process"}},[e._v("#")]),e._v(" Settlement Process")]),e._v(" "),n("h2",{attrs:{id:"_1-database-design"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-database-design"}},[e._v("#")]),e._v(" 1. Database Design")]),e._v(" "),n("h3",{attrs:{id:"notes"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#notes"}},[e._v("#")]),e._v(" Notes:")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("settlementWindow")]),e._v(" - a table where all settlement windows are stored;")]),e._v(" "),n("li",[n("code",[e._v("settlementWindowStateChange")]),e._v(" - stores information regarding settlement windows state;")]),e._v(" "),n("li",[n("code",[e._v("settlement")]),e._v(" - keeps data regarding all settlements;")]),e._v(" "),n("li",[n("code",[e._v("settlementSettlementWindow")]),e._v(" - association table for settlements and settlement windows, providing connection many-to-many;")]),e._v(" "),n("li",[n("code",[e._v("settlementStateChange")]),e._v(" - tracks the settlement state change;")]),e._v(" "),n("li",[n("code",[e._v("settlementTransferParticipant")]),e._v(" - this table is used for staging data for all transfers which are to be included in a settlement;")]),e._v(" "),n("li",[n("code",[e._v("settlementParticipantCurrency")]),e._v(" - stores grouped information by participant and currency. For calculation of netAmount, the summarized data from "),n("code",[e._v("settlementTransferParticipant")]),e._v(" is used;")]),e._v(" "),n("li",[n("code",[e._v("settlementParticipantCurrencyStateChange")]),e._v(" - used to track the state change of each individual settlement participant account.")])]),e._v(" "),n("p",[e._v("The remaining tables in the below ERD are either transfer-specific (gray) or lookup (blue) and are included as direct dependencies to depict the relation between the settlement tables and transfer specific entities.")]),e._v(" "),n("p",[n("img",{attrs:{src:a(354),alt:"Central Settlements. Service ERD"}})]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"./assets/entities/central-settlements-db-schema-dbeaver.erd"}},[e._v("Central Settlements Service DBeaver ERD")])])]),e._v(" "),n("h2",{attrs:{id:"_2-sequence-diagrams"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-sequence-diagrams"}},[e._v("#")]),e._v(" 2. Sequence diagrams")]),e._v(" "),n("h3",{attrs:{id:"_2-1-settlement-windows-by-params"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-settlement-windows-by-params"}},[e._v("#")]),e._v(" 2.1. Settlement Windows By Params")]),e._v(" "),n("p",[e._v("Used for acquiring information regarding Settlement Windows. E.g.:")]),e._v(" "),n("ol",[n("li",[e._v("Find the ID of the current OPEN window by querying by state and later use the information for closing that window;")]),e._v(" "),n("li",[e._v("Find all CLOSED and/or ABORTED windows to be used for creating a settlement;")]),e._v(" "),n("li",[e._v("Other reporting needs.")])]),e._v(" "),n("ul",[n("li",[n("RouterLink",{attrs:{to:"/mojaloop-technical-overview/central-settlements/settlement-process/get-settlement-windows-by-params.html"}},[e._v("Sequence Diagram for Get Settlement Windows by Parameters")])],1)]),e._v(" "),n("h3",{attrs:{id:"_2-2-settlement-windows-by-params"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-settlement-windows-by-params"}},[e._v("#")]),e._v(" 2.2. Settlement Windows By Params")]),e._v(" "),n("p",[e._v("Used for acquiring settlement window information when ID is present.")]),e._v(" "),n("ul",[n("li",[n("RouterLink",{attrs:{to:"/mojaloop-technical-overview/central-settlements/settlement-process/get-settlement-window-by-id.html"}},[e._v("Sequence Diagram for Request Settlement Window by Id")])],1)]),e._v(" "),n("h3",{attrs:{id:"_2-3-close-settlement-window"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-close-settlement-window"}},[e._v("#")]),e._v(" 2.3. Close Settlement Window")]),e._v(" "),n("p",[e._v("There is always one open settlement window which groups all ongoing transfers. This functionality is used to close the currently opened window and create the next one.")]),e._v(" "),n("ul",[n("li",[n("RouterLink",{attrs:{to:"/mojaloop-technical-overview/central-settlements/settlement-process/post-close-settlement-window.html"}},[e._v("Sequence Diagram for Close Settlement Window")])],1)]),e._v(" "),n("h3",{attrs:{id:"_2-4-create-settlement"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-create-settlement"}},[e._v("#")]),e._v(" 2.4. Create Settlement")]),e._v(" "),n("p",[e._v("The creation of settlement is possible when at least one OPEN or ABORTED window is provided. The data from all transfers in all provided windows is summarized and as a result the settlement amount is calculated per participant and currency. Depending on its sign we distinct 3 types of participants in regards to the newly created settlement: SETTLEMENT_NET_RECIPIENT, SETTLEMENT_NET_SENDER and SETTLEMENT_NET_ZERO. Newly generated id of type bigint is returned as a response together it all other information.")]),e._v(" "),n("ul",[n("li",[n("RouterLink",{attrs:{to:"/mojaloop-technical-overview/central-settlements/settlement-process/post-create-settlement.html"}},[e._v("Sequence Diagram for Trigger Settlement Event")])],1)]),e._v(" "),n("h3",{attrs:{id:"_2-5-request-settlement"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-request-settlement"}},[e._v("#")]),e._v(" 2.5. Request Settlement")]),e._v(" "),n("p",[e._v("This endpoint is used for acquiring information regarding a settlement and all included windows and accounts/positions. The ID from the previous request is being utilized for that purpose.")]),e._v(" "),n("ul",[n("li",[n("RouterLink",{attrs:{to:"/mojaloop-technical-overview/central-settlements/settlement-process/get-settlement-by-id.html"}},[e._v("Sequence Diagram for Get Settlement by Id")])],1)]),e._v(" "),n("h3",{attrs:{id:"_2-6-settlement-transfer-acknowledgment"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-settlement-transfer-acknowledgment"}},[e._v("#")]),e._v(" 2.6. Settlement Transfer Acknowledgment")]),e._v(" "),n("p",[e._v("It is used to advance the settlement through all the states initiated with the creation and finilized by settle or abort. The actual state flow is:")]),e._v(" "),n("ul",[n("li",[e._v("PENDING_SETTLEMENT: The net settlement report for this window has been taken, with the parameter set to indicate that settlement is to be processed;")]),e._v(" "),n("li",[e._v('PS_TRANSFERS_RECORDED: Record transfer entries against the Position Account and the Multi-lateral Net Settlement Account, these are the "multi-lateral netÂ  settlement transfers" (MLNS transfers). An identifier might be provided to be past to the reference bank;')]),e._v(" "),n("li",[e._v("PS_TRANSFERS_RESERVED: All the debit entries for the MLNS transfers are reserved;")]),e._v(" "),n("li",[e._v("PS_TRANSFERS_COMMITTED: All the credit entries for the MLNS transfers are committed. An identifier might be received and recorded from the Settlement bank to allow reconciliation;")]),e._v(" "),n("li",[e._v("SETTLING: If all accounts are not yet SETTLED, the Status of the settlement is moved to SETTLING. Note: applies only on settlement level;")]),e._v(" "),n("li",[e._v("SETTLED: Final state when all outstanding accounts are SETTLED, the entire Settlement is moved to SETTLED.")])]),e._v(" "),n("p",[n("RouterLink",{attrs:{to:"/mojaloop-technical-overview/central-settlements/settlement-process/put-settlement-transfer-ack.html"}},[e._v("Sequence Diagram for Acknowledgement of Settlement Transfer")])],1),e._v(" "),n("h3",{attrs:{id:"_2-7-settlement-abort"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-settlement-abort"}},[e._v("#")]),e._v(" 2.7. Settlement Abort")]),e._v(" "),n("ul",[n("li",[e._v("ABORTED: Final state when the settlement is not possible. Please, note the settlement might be aborted up to when no account/position has been marked as PS_TRANSFERS_COMMITTED. Also there is no possibility to mark an individual account as ABORTED, but rahter the entire settlement is ABORTED. After performing such operation there is possibility to create a new settlement by including only non-problematic ABORTED accounts")])]),e._v(" "),n("p",[n("RouterLink",{attrs:{to:"/mojaloop-technical-overview/central-settlements/settlement-process/put-settlement-abort.html"}},[e._v("Sequence Diagram for Settlement Abort")])],1),e._v(" "),n("h3",{attrs:{id:"_2-8-request-settlement-by-spa"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-request-settlement-by-spa"}},[e._v("#")]),e._v(" 2.8. Request Settlement By SPA")]),e._v(" "),n("p",[e._v("Used to request drill-down information regarding a settlement, participant and account. Even though participant and account are optional, the order settlement/{id}/participant/{id}/account/{id} is mandatory.")]),e._v(" "),n("ul",[n("li",[n("RouterLink",{attrs:{to:"/mojaloop-technical-overview/central-settlements/settlement-process/get-settlement-by-spa.html"}},[e._v("Sequence Diagram for Get Settlement by Settlement/Participant/Account")])],1)]),e._v(" "),n("h3",{attrs:{id:"_2-9-request-settlements-by-params"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-9-request-settlements-by-params"}},[e._v("#")]),e._v(" 2.9. Request Settlements By Params")]),e._v(" "),n("p",[e._v("This endpoint enables advanced reporting capabilities.")]),e._v(" "),n("ul",[n("li",[n("RouterLink",{attrs:{to:"/mojaloop-technical-overview/central-settlements/settlement-process/get-settlements-by-params.html"}},[e._v("Sequence Diagram for Query Settlements by Parameters")])],1)])])}),[],!1,null,null,null);t.default=s.exports}}]);