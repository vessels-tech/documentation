(window.webpackJsonp=window.webpackJsonp||[]).push([[126],{512:function(t,s,e){"use strict";e.r(s);var a=e(43),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"get-health-check"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#get-health-check"}},[t._v("#")]),t._v(" GET Health Check")]),t._v(" "),e("p",[t._v("Design discussion for new Health Check implementation.")]),t._v(" "),e("h2",{attrs:{id:"objectives"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#objectives"}},[t._v("#")]),t._v(" Objectives")]),t._v(" "),e("p",[t._v("The goal for this design is to implement a new Health check for mojaloop switch services that allows for a greater level of detail.")]),t._v(" "),e("p",[t._v("It Features:")]),t._v(" "),e("ul",[e("li",[t._v("Clear HTTP Statuses (no need to inspect the response to know there are no issues)")]),t._v(" "),e("li",[t._v("~Backwards compatibility with existing health checks~ - No longer a requirement. See "),e("a",{attrs:{href:"https://github.com/mojaloop/project/issues/796#issuecomment-498350828",target:"_blank",rel:"noopener noreferrer"}},[t._v("this discussion"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("li",[t._v("Information about the version of the API, and how long it has been running for")]),t._v(" "),e("li",[t._v("Information about sub-service (kafka, logging sidecar and mysql) connections")])]),t._v(" "),e("h2",{attrs:{id:"request-format"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#request-format"}},[t._v("#")]),t._v(" Request Format")]),t._v(" "),e("p",[e("code",[t._v("/health")])]),t._v(" "),e("p",[t._v("Uses the newly implemented health check. As discussed "),e("a",{attrs:{href:"https://github.com/mojaloop/project/issues/796#issuecomment-498350828",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),e("OutboundLink")],1),t._v(" since there will be no added connection overhead (e.g. pinging a database) as part of implementing the health check, there is no need to complicate things with a simple and detailed version.")]),t._v(" "),e("p",[t._v("Responses Codes:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("200")]),t._v(" - Success. The API is up and running, and is sucessfully connected to necessary services.")]),t._v(" "),e("li",[e("code",[t._v("502")]),t._v(" - Bad Gateway. The API is up and running, but the API cannot connect to necessary service (eg. "),e("code",[t._v("kafka")]),t._v(").")]),t._v(" "),e("li",[e("code",[t._v("503")]),t._v(" - Service Unavailable. This response is not implemented in this design, but will be the default if the api is not and running")])]),t._v(" "),e("h2",{attrs:{id:"response-format"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#response-format"}},[t._v("#")]),t._v(" Response Format")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Type")]),t._v(" "),e("th",[t._v("Description")]),t._v(" "),e("th",[t._v("Example")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("code",[t._v("status")])]),t._v(" "),e("td",[e("code",[t._v("statusEnum")])]),t._v(" "),e("td",[t._v("The status of the service. Options are "),e("code",[t._v("OK")]),t._v(" and "),e("code",[t._v("DOWN")]),t._v(". "),e("em",[t._v("See "),e("code",[t._v("statusEnum")]),t._v(" below")]),t._v(".")]),t._v(" "),e("td",[e("code",[t._v('"OK"')])])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("uptime")])]),t._v(" "),e("td",[e("code",[t._v("number")])]),t._v(" "),e("td",[t._v("How long (in seconds) the service has been alive for.")]),t._v(" "),e("td",[e("code",[t._v("123456")])])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("started")])]),t._v(" "),e("td",[e("code",[t._v("string")]),t._v(" (ISO formatted date-time)")]),t._v(" "),e("td",[t._v("When the service was started (UTC)")]),t._v(" "),e("td",[e("code",[t._v('"2019-05-31T05:09:25.409Z"')])])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("versionNumber")])]),t._v(" "),e("td",[e("code",[t._v("string")]),t._v(" (semver)")]),t._v(" "),e("td",[t._v("The current version of the service.")]),t._v(" "),e("td",[e("code",[t._v('"5.2.5"')])])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("services")])]),t._v(" "),e("td",[e("code",[t._v("Array<serviceHealth>")])]),t._v(" "),e("td",[t._v("A list of services this service depends on, and their connection status")]),t._v(" "),e("td",[e("em",[t._v("see below")])])])])]),t._v(" "),e("h3",{attrs:{id:"servicehealth"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#servicehealth"}},[t._v("#")]),t._v(" serviceHealth")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Type")]),t._v(" "),e("th",[t._v("Description")]),t._v(" "),e("th",[t._v("Example")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("code",[t._v("name")])]),t._v(" "),e("td",[e("code",[t._v("subServiceEnum")])]),t._v(" "),e("td",[t._v("The sub-service name. "),e("em",[t._v("See "),e("code",[t._v("subServiceEnum")]),t._v(" below")]),t._v(".")]),t._v(" "),e("td",[e("code",[t._v('"broker"')])])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("status")])]),t._v(" "),e("td",[e("code",[t._v("enum")])]),t._v(" "),e("td",[t._v("The status of the service. Options are "),e("code",[t._v("OK")]),t._v(" and "),e("code",[t._v("DOWN")])]),t._v(" "),e("td",[e("code",[t._v('"OK"')])])])])]),t._v(" "),e("h3",{attrs:{id:"subserviceenum"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#subserviceenum"}},[t._v("#")]),t._v(" subServiceEnum")]),t._v(" "),e("p",[t._v("The subServiceEnum enum describes a name of the subservice:")]),t._v(" "),e("p",[t._v("Options:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("datastore")]),t._v(" -> The database for this service (typically a MySQL Database).")]),t._v(" "),e("li",[e("code",[t._v("broker")]),t._v("    -> The message broker for this service (typically Kafka).")]),t._v(" "),e("li",[e("code",[t._v("sidecar")]),t._v("   -> The logging sidecar sub-service this service attaches to.")]),t._v(" "),e("li",[e("code",[t._v("cache")]),t._v("     -> The caching sub-service this services attaches to.")])]),t._v(" "),e("h3",{attrs:{id:"statusenum"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#statusenum"}},[t._v("#")]),t._v(" statusEnum")]),t._v(" "),e("p",[t._v("The status enum represents status of the system or sub-service.")]),t._v(" "),e("p",[t._v("It has two options:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("OK")]),t._v("    -> The service or sub-service is healthy.")]),t._v(" "),e("li",[e("code",[t._v("DOWN")]),t._v("  -> The service or sub-service is unhealthy.")])]),t._v(" "),e("p",[t._v("When a service is "),e("code",[t._v("OK")]),t._v(": the API is considered healthy, and all sub-services are also considered healthy.")]),t._v(" "),e("p",[t._v("If "),e("strong",[t._v("any")]),t._v(" sub-service is "),e("code",[t._v("DOWN")]),t._v(", then the entire health check will fail, and the API will be considered "),e("code",[t._v("DOWN")]),t._v(".")]),t._v(" "),e("h2",{attrs:{id:"defining-sub-service-health"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#defining-sub-service-health"}},[t._v("#")]),t._v(" Defining Sub-Service health")]),t._v(" "),e("p",[t._v("It is not enough to simply ping a sub-service to know if it is healthy, we want to go one step further. These criteria will change with each sub-service.")]),t._v(" "),e("h3",{attrs:{id:"datastore"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#datastore"}},[t._v("#")]),t._v(" "),e("code",[t._v("datastore")])]),t._v(" "),e("p",[t._v("For "),e("code",[t._v("datastore")]),t._v(", a status of "),e("code",[t._v("OK")]),t._v(" means:")]),t._v(" "),e("ul",[e("li",[t._v("An existing connection to the database")]),t._v(" "),e("li",[t._v("The database is not empty (contains more than 1 table)")])]),t._v(" "),e("h3",{attrs:{id:"broker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#broker"}},[t._v("#")]),t._v(" "),e("code",[t._v("broker")])]),t._v(" "),e("p",[t._v("For "),e("code",[t._v("broker")]),t._v(", a status of "),e("code",[t._v("OK")]),t._v(" means:")]),t._v(" "),e("ul",[e("li",[t._v("An existing connection to the kafka broker")]),t._v(" "),e("li",[t._v("The necessary topics exist. This will change depending on which service the health check is running for.")])]),t._v(" "),e("p",[t._v("For example, for the "),e("code",[t._v("central-ledger")]),t._v(" service to be considered healthy, the following topics need to be found:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("topic-admin-transfer\ntopic-transfer-prepare\ntopic-transfer-position\ntopic-transfer-fulfil\n")])])]),e("h3",{attrs:{id:"sidecar"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sidecar"}},[t._v("#")]),t._v(" "),e("code",[t._v("sidecar")])]),t._v(" "),e("p",[t._v("For "),e("code",[t._v("sidecar")]),t._v(", a status of "),e("code",[t._v("OK")]),t._v(" means:")]),t._v(" "),e("ul",[e("li",[t._v("An existing connection to the sidecar")])]),t._v(" "),e("h3",{attrs:{id:"cache"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cache"}},[t._v("#")]),t._v(" "),e("code",[t._v("cache")])]),t._v(" "),e("p",[t._v("For "),e("code",[t._v("cache")]),t._v(", a status of "),e("code",[t._v("OK")]),t._v(" means:")]),t._v(" "),e("ul",[e("li",[t._v("An existing connection to the cache")])]),t._v(" "),e("h2",{attrs:{id:"swagger-definition"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#swagger-definition"}},[t._v("#")]),t._v(" Swagger Definition")]),t._v(" "),e("blockquote",[e("p",[e("em",[t._v("Note: These will be added to the existing swagger definitions for the following services:")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("ml-api-adapter")])]),t._v(" "),e("li",[e("code",[t._v("central-ledger")])]),t._v(" "),e("li",[e("code",[t._v("central-settlement")])]),t._v(" "),e("li",[e("code",[t._v("central-event-processor")])]),t._v(" "),e("li",[e("code",[t._v("email-notifier")])])])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// . . . ")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"/health"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"get"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"operationId"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"getHealth"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"tags"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"health"')]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"responses"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"schema"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"$ref"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#/definitions/health"')]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Successful"')]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// . . .")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"definitions"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"health"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"object"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"properties"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enum"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OK"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DOWN"')]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"uptime"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"How long (in seconds) the service has been alive for."')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"number"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"started"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"When the service was started (UTC)"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"format"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"date-time"')]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"versionNumber"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"The current version of the service."')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"example"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"5.2.3"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"services"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A list of services this service depends on, and their connection status"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"array"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"items"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"$ref"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#/definitions/serviceHealth"')]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"serviceHealth"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"object"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"properties"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"The sub-service name."')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enum"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"datastore"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"broker"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sidecar"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cache"')]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"The connection status with the service."')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enum"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OK"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DOWN"')]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"example-requests-and-responses"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#example-requests-and-responses"}},[t._v("#")]),t._v(" Example Requests and Responses:")]),t._v(" "),e("p",[e("strong",[t._v("Successful Legacy Health Check:")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("GET /health HTTP/1.1\nContent-Type: application/json\n\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" SUCCESS\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"status"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OK"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Successful New Health Check:")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('GET /health?detailed=true HTTP/1.1\nContent-Type: application/json\n\n200 SUCCESS\n{\n  "status": "OK",\n  "uptime": 0,\n  "started": "2019-05-31T05:09:25.409Z",\n  "versionNumber": "5.2.3",\n  "services": [\n    {\n      "name": "broker",\n      "status": "OK",\n    }\n  ]\n}\n')])])]),e("p",[e("strong",[t._v("Failed Health Check, but API is up:")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('GET /health?detailed=true HTTP/1.1\nContent-Type: application/json\n\n502 BAD GATEWAY\n{\n  "status": "DOWN",\n  "uptime": 0,\n  "started": "2019-05-31T05:09:25.409Z",\n  "versionNumber": "5.2.3",\n  "services": [\n    {\n      "name": "broker",\n      "status": "DOWN",\n    }\n  ]\n}\n')])])]),e("p",[e("strong",[t._v("Failed Health Check:")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("GET /health?detailed=true HTTP/1.1\nContent-Type: application/json\n\n503 SERVICE UNAVAILABLE\n")])])]),e("h2",{attrs:{id:"sequence-diagram"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sequence-diagram"}},[t._v("#")]),t._v(" Sequence Diagram")]),t._v(" "),e("p",[t._v("Sequence design diagram for the GET Health")])])}),[],!1,null,null,null);s.default=n.exports}}]);